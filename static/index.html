<!DOCTYPE html>
<html>
<head lang='en'>
    <meta charset='UTF-8'>
    <title>Visualizer</title>
    <script src="{{ config.cdn | concat('/lib/jquery/2.1.1/jquery.min.js') | processUrl('..') }}"></script>
    <script src="{{ config.cdn | concat('/lib/uri.js/1.14.1/URI.min.js') | processUrl('..') }}"></script>
    <style>
        #ci-visualizer {
            min-height: 100vh;
        }
        body {
            margin: 0;
        }
    </style>
</head>
<body>
<div id='ci-visualizer'></div>
<script>
    $(document).ready(function () {
        var cdn = '{{config.cdn}}';
        var direct = '{{config.direct}}';

        var $div = $('#ci-visualizer');
        $div.attr('config', './editConfig.json');
        var visualizer = document.createElement('script');
        var uri = new URI(document.location.href);
        var query = uri.search(true);
        if(query.close) {
            window.close();
        }
        var version = 'HEAD-min';
        if (query.v) {
            version = query.v;
        }
        var prefix = (query.direct ? direct : cdn) + '/visualizer/';
        visualizer.setAttribute('data-main', prefix + version + '/init');
        visualizer.setAttribute('src', prefix + version + '/components/requirejs/require.js');
        document.head.appendChild(visualizer);
    });
</script>
</body>
</html>