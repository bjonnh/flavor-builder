{% extends '../bootstrapmenu.html' %}

{% block head %}

{% parent %}
<link rel="stylesheet" href="{{ reldir }}/themes/bootstrap/css/custom-simple.css"/>

<script>

console.log("In iframe");

var messages={};
var messageID=0;

var appWindow, appOrigin;


function postMessage(action, data, callback) {
    if (!appWindow || !appOrigin) {
        console.log('Don\'t know where to send messages to, app hasn\'t initialized us yet.');
        return;
    }
    messageID++;
    appWindow.postMessage(
        {
            action: action,
            messageID:messageID,
            message: data
        }, appOrigin
    );
    messages[messageID]={
        action:action,
        messageID:messageID,
        message: data,
        callback: callback
    }
}

window.addEventListener("message", receiveMessage, false);

function receiveMessage(event) {
    if (!appWindow || !appOrigin) {
        appWindow = event.source;
        appOrigin = event.origin;
    }
    var messageID=event.data.messageID;
    if (messages[messageID] && messages[messageID].callback) {
        console.log("In call back");
        messages[messageID].callback(event);
        delete messages[messageID];
    } else {

    }
}

</script>

{% endblock head %}



{% block content %}

{% endblock content%}
